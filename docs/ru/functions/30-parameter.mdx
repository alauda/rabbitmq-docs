---
weight: 30
sourceSHA: 39e31d436c52a92da4279ef1dc4adc94664d4ec1dfc0a7ebd75d4c3f39c58c75
---

# Конфигурация параметров

Экземпляр RabbitMQ по умолчанию использует системные параметры, предоставленные RabbitMQ. Вы также можете удобно настроить параметры через интерфейс.

<Directive type="info" title="Совет">
  После обновления RabbitMQ, если есть параметры, которые необходимо удалить, которые устарели или которые нужно изменить, пожалуйста, обратитесь к [официальному сайту RabbitMQ](https://www.rabbitmq.com/configure.html#config-items) для соответствующих изменений.
</Directive>

<Directive type="warning" title="Предупреждение">
  Обновление параметров приведет к перезапуску экземпляра. Для стабильности вашего приложения, пожалуйста, обновляйте параметры в часы низкой нагрузки.
</Directive>

## Процедура

<Tabs>
  <Tab label="CLI">
    Параметры для узлов данных экземпляра задаются через поле `spec.rabbitmq.additionalConfig` ресурса RabbitMQ CR.

    ```bash
    # Обновите конфигурацию узла данных экземпляра s6
    $ kubectl -n default patch rabbitmqclusters <имя экземпляра> --type=merge --patch='{"spec": {"rabbitmq": {"additionalConfig":"channel_max=1000"}}}''
    ```
  </Tab>

  <Tab label="Веб-консоль">
    1. Нажмите **RabbitMQ** в левой навигационной панели.

    2. Нажмите на ***название пространства имён***.

    3. Нажмите на ***имя экземпляра***.

    4. Вкладка **Параметры**, нажмите **Обновить параметры**.

    5. Установите параметры.

    6. Нажмите **Обновить**.
  </Tab>
</Tabs>

## Описание поддержки параметров

| Название параметра                         | Описание параметра                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Диапазон значений                                                                     | Значение по умолчанию                            |
| ------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- | ------------------------------------------------ |
| num\_acceptors.tcp                         | Количество процессов Erlang, которые будут принимать соединения для TCP слушателей.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | -                                                                                     | num\_acceptors.tcp = 10                          |
| handshake\_timeout                         | Максимальное время для рукопожатия AMQP 0-9-1 (после соединения сокетов и рукопожатия TLS), в миллисекундах.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | -                                                                                     | handshake\_timeout = 10000                       |
| vm\_memory\_high\_watermark.relative       | Порог памяти, при котором активируется управление потоком. Это может быть абсолютным или относительным по отношению к объему ОЗУ, доступному ОС.                                                                                                                                                                                                                                                                                                                                                                                                                       | -                                                                                     | vm\_memory\_high\_watermark.relative = 0.4       |
| vm\_memory\_calculation\_strategy          | Стратегия отчетности по использованию памяти                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | allocated<br /><br />rss<br /><br />legacy<br /><br />erlang                          | vm\_memory\_calculation\_strategy = allocated    |
| vm\_memory\_high\_watermark\_paging\_ratio | Доля лимита высокого уровня, при достижении которой очереди начинают переносить сообщения на диск, чтобы освободить память. См. документацию по [управлению потоком на основе памяти](https://www.rabbitmq.com/memory.html).                                                                                                                                                                                                                                                                                                                                                   | -                                                                                     | vm\_memory\_high\_watermark\_paging\_ratio = 0.5 |
| total\_memory\_available\_override\_value  | Позволяет переопределить общее количество доступной памяти, вместо того чтобы выводить ее из окружающей среды с помощью специфических для ОС средств. Это следует использовать только тогда, когда фактическое максимальное количество ОЗУ, доступного узлу, не соответствует значению, выведенному узлом, например, из-за контейнеризации или аналогичных ограничений, неизвестных узлу. Значение может быть задано в виде целого числа байт или, альтернативно, в удобочитаемых единицах (например, `8GB`). Например, при установке на 4 ГБ узел считает, что он работает на машине с 4 ГБ ОЗУ. | -                                                                                     | -                                                |
| disk\_free\_limit.absolute                 | Лимит свободного места на диске для раздела, на котором RabbitMQ хранит данные. Когда доступное место на диске падает ниже этого лимита, управляется поток. Значение может быть установлено относительно общего объема ОЗУ или как абсолютное значение в байтах или, альтернативно, в удобочитаемых единицах (например, `50MB` или `5GB`).                                                                                                                                                                                                                                  | -                                                                                     | disk\_free\_limit.absolute = 50MB                |
| log.file.level                             | Контролирует детальность ведения журнала. Значение представляет собой список пар категорий событий журнала и уровней журнала.                                                                                                                                                                                                                                                                                                                                                                                                                                                   | error<br /><br />warning<br /><br />info<br /><br />debug                             | log.file.level = info                            |
| channel\_max                               | Максимальное допустимое количество каналов, которые могут быть согласованы с клиентами, исключая специальный номер канала 0, используемый в протоколе. Установка на 0 означает «неограничено», что является опасным значением, поскольку приложения иногда могут иметь утечки каналов. Использование большего количества каналов увеличивает объем памяти, занимаемой брокером.                                                                                                                                                                                                                              | -                                                                                     | channel\_max = 2047                              |
| channel\_operation\_timeout                | Тайм-аут операций канала в миллисекундах (используется внутренне, не открывается напрямую для клиентов из-за различий в протоколах сообщений и ограничений).                                                                                                                                                                                                                                                                                                                                                                                                   | -                                                                                     | channel\_operation\_timeout = 15000              |
| max\_message\_size                         | Максимально допустимый размер полезной нагрузки сообщения в байтах. Сообщения, превышающие этот размер, будут отклонены с подходящим исключением канала.                                                                                                                                                                                                                                                                                                                                                                                                                     | Максимальное значение: 536870912                                                                  | max\_message\_size = 134217728                   |
| heartbeat                                  | Значение, представляющее тайм-аут сердцебиения, предложенный сервером во время согласования параметров соединения. Если установить значение 0 на обоих концах, сердцебиения отключены (это не рекомендуется). См. [руководство по сердцебиениям](https://www.rabbitmq.com/heartbeats.html) для подробностей.                                                                                                                                                                                                                                                                              | -                                                                                     | heartbeat = 60                                   |
| default\_vhost                             | Виртуальный хост, создаваемый при создании новой базы данных RabbitMQ с нуля. Обмен `amq.rabbitmq.log` будет существовать в этом виртуальном хосте.                                                                                                                                                                                                                                                                                                                                                                                                              | -                                                                                     | default\_vhost = /                               |
| collect\_statistics                        | Режим сбора статистики. В основном актуален для плагина управления.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | none<br /><br />coarse<br /><br />fine                                                | collect\_statistics = none                       |
| collect\_statistics\_interval              | Интервал сбора статистики в миллисекундах. В основном актуален для [плагина управления](https://www.rabbitmq.com/management.html#statistics-interval).                                                                                                                                                                                                                                                                                                                                                                                         | -                                                                                     | collect\_statistics\_interval = 5000             |
| management\_db\_cache\_multiplier          | Влияет на количество времени, в течение которого [плагин управления](https://www.rabbitmq.com/management.html#statistics-interval) кеширует дорогостоящие управленческие запросы, такие как списки очередей. Кеш умножит прошедшее время последнего запроса на это значение и закеширует результат на этот срок.                                                                                                                                                                                                                                                        | -                                                                                     | management\_db\_cache\_multiplier = 5            |
| delegate\_count                            | Количество процессов делегирования, которые будут использоваться для внутрекластерного общения. На машинах с очень большим количеством ядер и которые также являются частью кластера, вы можете увеличить это значение.                                                                                                                                                                                                                                                                                                                                                          | -                                                                                     | delegate\_count = 16                             |
| hipe\_compile                              | Не используйте. Эта опция больше не поддерживается. Поддержка HiPE была прекращена, начиная с Erlang 22.                                                                                                                                                                                                                                                                                                                                                                                                                                                | -                                                                                     | hipe\_compile = false                            |
| cluster\_partition\_handling               | Как обрабатывать сетевые разделения.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | ignore<br /><br />autoheal<br /><br />pause\_minority<br /><br />pause\_if\_all\_down | cluster\_partition\_handling = ignore            |
| cluster\_keepalive\_interval               | С какой частотой узлы должны отправлять сообщения о поддержании связи друг другу (в миллисекундах). Обратите внимание, что это не то же самое, что [net\_ticktime](https://www.rabbitmq.com/nettick.html); пропущенные сообщения о поддержании связи не приведут к тому, что узлы будут считаться неработающими.                                                                                                                                                                                                                                                                                                  | -                                                                                     | cluster\_keepalive\_interval = 10000             |
| queue\_index\_embed\_msgs\_below           | Размер в байтах сообщений, ниже которого сообщения будут встроены напрямую в индекс очереди. Рекомендуется обратиться к документации по [настройке персистеров](https://www.rabbitmq.com/persistence-conf.html) перед внесением изменений.                                                                                                                                                                                                                                                                                                                  | -                                                                                     | queue\_index\_embed\_msgs\_below = 4096          |
| mnesia\_table\_loading\_retry\_timeout     | Тайм-аут, используемый при ожидании, когда таблицы Mnesia в кластере станут доступными.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | -                                                                                     | mnesia\_table\_loading\_retry\_timeout = 30000   |
| mnesia\_table\_loading\_retry\_limit       | Количество попыток при ожидании таблиц Mnesia во время старта кластера. Обратите внимание, что эта настройка не применяется к обновлениям Mnesia или удалению узлов.                                                                                                                                                                                                                                                                                                                                                                                                  | -                                                                                     | mnesia\_table\_loading\_retry\_limit = 10        |
| mirroring\_sync\_batch\_size               | Размер пакета, используемый для передачи сообщений на несинхронизированную реплику (зеркало очереди). См. [документацию по стремительной пакетной синхронизации](https://www.rabbitmq.com/ha.html#batch-sync).                                                                                                                                                                                                                                                                                                                                                                    | -                                                                                     | mirroring\_sync\_batch\_size = 4096              |
| queue\_master\_locator                     | Стратегия расположения лидера очереди. Доступные стратегии:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | min-masters<br /><br />client-local<br /><br />random                                 | queue\_master\_locator = client-local            |

Для получения дополнительной информации о поддерживаемых параметрах, пожалуйста, обратитесь к [официальному сайту RabbitMQ](https://www.rabbitmq.com/configure.html#config-items).
