---
weight: 75
---

# 监控告警

内嵌面板中的监控数据可用于从资源、性能等方面进行 RabbitMQ 监控与告警，且支持配置通知策略。

直观呈现的监控数据可用于为运维巡检或性能调优提供决策支持，完善的告警和通知机制也将帮助保障数据库稳定运行。

## 监控

平台默认收集 RabbitMQ 的资源、性能等常用监控指标。在实例的 **监控** 页签中，可查看指标的实时监控数据。


| 类别                 | 指标                                                         |
| -------------------- | ------------------------------------------------------------ |
| **节点监控**         | 节点的可用内存，磁盘，文件描述符 等指标监控 |
| **消息监控**         | 收发的消息监控等                           |
| **队列监控**         | 队列总体的监控 |
| **Channel 监控**     | Channel 总体监控 |
| **连接监控**         | 客户端连接总体监控 |

> RabbitMQ 的 metrics 主要暴露了各个组件总体指标，因而默认监控面板无法精确监控某个`Queue`或者 `Exchange`的状况。

## 告警

进入 Application Service 的 **告警** > **告警策略** 页面，可为 RabbitMQ 创建告警对应的告警策略(也可以使用平台通用的告警功能去创建告警）。

### 配置告警策略

为启用告警，请先在 Application Service 中创建告警策略。告警策略描述了您希望监控的对象、在什么情况下希望收到告警，以及如何被通知相关告警。

平台内置了如下告警指标：

| 名称                | 推荐触发条件       | 说明           |
|:--------------------|:-------------------|:---------------|
| 实例可用性          | \!\=1，且持续30秒   | 监控集群的可用性 |
| 信道数量            | 根据实际规格和应用客户端来设置阈值  | 实时监控 Channel 数量                               |
| 消息写入频次        | 根据实际规格来设置阈值  | 实时监控消息写入频次                                |
| 连接数              | 根据实际规格来设置阈值  | 实时监控连接数                                      |
| 队列数量            | 根据实际规格来设置阈值  | 实时监控队列数量                                    |
| 节点 CPU 使用率     | \>80%，且持续30秒   | 实时监控 CPU 情况，如果 CPU 占用过大，需要考虑扩容。|
| 节点内存使用率      | \>80%，且持续30秒   | 实时监控内存情况，如果内存占用过大，需要立即扩容。  |
| 节点存储空间使用率  | \>80%，且持续30秒   | 实时监控存储空间情况，如果占用过大，需要考虑扩容。  |

通过以上告警指标可快速创建告警策略。

除了内置告警指标，还可以自定义告警指标。自定义告警需要自己编辑 PromQL，并提交到告警指标表单中。PromQL 是一个比较复杂的表达式，可使用自带的 Prometheus Console 来编辑调试 PromQL。关于 PromQL 基础支持，可参考 [PromQL 官方文档](https://prometheus.io/docs/prometheus/latest/querying/basics/)。

更多关于告警的配置和使用，请参考<ExternalSiteLink name="acp" href="appservice/unified-om/alert-policy-mgt/index" children="告警策略管理" />。

